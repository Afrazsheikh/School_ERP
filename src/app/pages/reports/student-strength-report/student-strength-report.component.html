<app-layout>
  <div class="container-fluid p-4">
   
      <div class="row mb-3">
          <div class="col-md-12 header-txt">
            <i _ngcontent-dan-c162="" class="fas fa-user-check"></i>&nbsp;&nbsp;<span>Student Strength </span>
          </div>
        </div>
      <div class="row mb-3">
          <form [formGroup]="reportForm">
              <div class="row mt-3 grey-border">
               <div class="mb-3 col-md-3">
                  <label class="form-label">Selete Type <span class="error">*</span></label>
                  <select id="type" class="form-select" formControlName="reportType"  (change)="onChangeClass($event)">
                   <option *ngFor="let sec of reportOption" [value]="sec.id">{{sec?.name}} </option>
                </select>
                     <div *ngIf="reportForm.controls['reportType'].invalid && (reportForm.controls['reportType'].dirty || reportForm.controls['reportType'].touched)"
                  class="error mt-2">
                  <div *ngIf="reportForm.controls['reportType'].errors['required']">
                    Report Type is required.
                  </div></div>
                </div>
                <div class="mb-3 col-md-3" *ngIf="reportForm.controls['reportType'].value !== 'month'">
                  <label class="form-label">Year <span class="error">*</span></label>
                  <select class="form-select" formControlName="academicYear">
                    <option  value="">Select</option>
                    <option *ngFor="let year of aceYear" [value]="year._id">{{year.name}}</option>
                  </select>
                  <div *ngIf="reportForm.controls['academicYear'].invalid && (reportForm.controls['academicYear'].dirty || reportForm.controls['academicYear'].touched)"
                  class="error mt-2">
                  <div *ngIf="reportForm.controls['academicYear'].errors['required']">
                    Year is required.
                  </div></div>
                </div>
                <div class="mb-3 col-md-3" *ngIf="reportForm.controls['reportType'].value === 'cast'">
                  <label class="form-label">Selete Cast <span class="error">*</span></label>
                  <select id="type" class="form-select" formControlName="cast">
                    <option value="">Select</option>
                    <option *ngFor="let day of castList" value="{{ day._id }}">
                      {{ day.name }}
                    </option>
                </select>
                </div> 
                <div class="col-md-4 mt-3 pt-2" *ngIf="reportForm.controls['reportType'].value === 'month'">
                  <mat-form-field>
                    <mat-label>Enter a date range</mat-label>
                    <mat-date-range-input [rangePicker]="picker">
                      <input matStartDate placeholder="Start date" formControlName="startDate">
                      <input matEndDate placeholder="End date" formControlName="endDate">
                    </mat-date-range-input>
                    <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-date-range-picker #picker></mat-date-range-picker>
                  </mat-form-field>
                </div> 
            <div class="col-md-3 mt-4">
              <button class="btn mt-2" (click)="callReport(reportForm)"  [disabled]="!reportForm.valid">Filter</button>
            </div>
              </div>             
          </form>  
      </div>
      <div class="row">
       
      </div>
      <div class="row mt-3">
        <div class="col-md-12" *ngIf="selectedType === 'cast'">
          <table class="table mt-3">
            <thead>
              <tr>
               <th>SL</th>
               <th>Cast</th>
                <th>Class </th>
                <th>No. of. Sections</th>      
                <th>No. of. Student</th>      
              </tr>
            </thead>
            <tbody>
              <ng-container *ngFor="let castRow of castDataArr; let i = index">
                <tr>
                  <td>{{i+1}}</td> 
                  <td>{{castRow?.caste}}</td>
                  <td>{{castRow?.studentClass?.className}}</td>            
                  <td>{{castRow?.section?.name}}</td>
                  <td>{{castRow?.total}}</td>
                </tr>
                </ng-container>              
            </tbody>
          </table>
        </div>
          <div class="col-md-12" *ngIf="selectedType === 'class' || selectedType === 'month'">
            <table class="table mt-3">
              <thead>
                <tr>
                 <th>SL</th>
                  <th>Class </th>
                  <th>No. of. Sections</th>      
                  <th>No. of. Student</th>      
                </tr>
              </thead>
              <tbody>
                <ng-container *ngFor="let genRow of monthDataArr; let i = index">
                  <tr>
                    <td>{{i+1}}</td> 
                    <td>{{genRow?.studentClass?.className}}</td>            
                    <td>{{genRow?.section?.name}}</td>
                    <td>{{genRow?.total}}</td>
                  </tr>
                </ng-container>
              </tbody>
            </table>
          </div>
          <div class="col-md-12" *ngIf="selectedType === 'gender'">
            <table class="table mt-3">
              <thead>
                <tr>
                 <th>SL</th>
                  <th>Class </th>
                  <th>No. of. Sections</th>      
                  <th>No. of. Student</th> 
                  <th>Boy</th>  
                  <th>Girl</th>   
                </tr>
              </thead>
              <tbody>
                <ng-container *ngFor="let genRow of genderDataArr; let i = index">
                  <tr>
                    <td>{{i+1}}</td> 
                    <td>{{genRow?.studentClass?.className}}</td>            
                    <td>{{genRow?.section?.name}}</td>
                    <td>{{genRow?.total}}</td>
                    <td>{{genRow?.boy}}</td>
                    <td>{{genRow?.girl}}</td>
                  </tr>
                  </ng-container> 
               
              </tbody>
            </table>
          </div>
      </div>
  </div>
</app-layout>