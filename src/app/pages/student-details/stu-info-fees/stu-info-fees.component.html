
<form [formGroup]="addForm">
  <div class="row">
      <div class="col-md-12 header-txt" >
          <span>Fee Mode Details</span>
      </div>
  </div> 

  <table class="table">
    <thead>
        <tr>
            <th></th>
             <th>Category Code</th>
             <th>Category Name</th>
             <th>Amount</th>
             <th>Concession</th>
             <th>Total Amount</th>
    </tr>
    </thead>
    <tbody> 
        <ng-container *ngFor="let row of addForm.get('rows')['controls']; let i = index">
             <tr>
                       <td><input type="checkbox" [formControl]="row.get('isChecked')" (change)="onCheckChange($event, i)" /></td>
                        <td>{{row.get('code').value}}</td>
                        <td>{{row.get('categoryName').value}}</td>
                        <td><input type="text" class="form-control" [formControl]="row.get('amount')" style="width:120px"></td>
                        <td><input type="text" class="form-control" [formControl]="row.get('concession')" style="width:120px" (focusout)='calculatePerc(i)'></td>
                        <td><input type="text" class="form-control" [formControl]="row.get('totalAmount')" style="width:120px"></td>
                </tr>
        </ng-container> 
        
    </tbody>
</table>
  <div class="row mt-3">
    <div class="col-4">
      <label class="form-label">Total Amount <span class="error">*</span></label>
      <input type="text" class="form-control"  formControlName="totalFinalAmount" readonly>
   </div>
    
    <div class="mb-3 col-md-4">
      <label class="form-label">Fee Mode <span class="error">*</span></label>
      <select class="form-select" formControlName="feeMode">
        <option  value="" >Select</option>
        <option *ngFor="let day of feeModeList" value="{{day._id}}">{{day.name}}</option>
      </select>
      <div *ngIf="addForm.controls['feeMode'].invalid && (addForm.controls['feeMode'].dirty || addForm.controls['feeMode'].touched)"
      class="error mt-2">
      <div *ngIf="addForm.controls['feeMode'].errors['required']">
        Fee Mode is required.
      </div></div>
    </div>
    <div class="col-md-3 mt-2">
      <button (click)="payNowClick(addForm)" class="btn mt-4"  [disabled]="!addForm.valid">Pay Now</button>
    </div>
  </div>
  <div class="row" *ngIf="row.isExpand">
    <div class="col-md-12 header-txt" >
        <span>Pay Invoice</span>
    </div>
</div> 
  <div class="row" *ngIf="row.isExpand">
    <table class="table table-bordered table-sm">
      <thead>
        <th></th>
        <th class="ps-3">Month </th>
        <th class="ps-3">Date</th>
        <th class="text-center">Status</th>
        <th>Action</th>
        
      </thead>
      <tbody>
        <ng-container  *ngFor="let row2 of availableMonths">
          <tr >
            <td class="ps-3">{{row2?.value}}</td>
            <td class="ps-3">{{row2?.months}}</td>
            <td class="ps-3">{{row2?.months}} 2023</td>
            <td class="text-center"> <span class="badge bg-danger">UnPaid</span></td>
            <td class="text-center"><button class="btn">Pay Now</button></td>
          </tr>
        </ng-container>
        
      </tbody>
    </table>
  </div>

</form>